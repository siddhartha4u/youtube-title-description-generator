<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>YouTube Title Generator</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
            margin: 0;
            background-color: #0d1117;
        }
    </style>
</head>
<body>
    <div id="app"></div>

    <script>
        // Main application logic for the YouTube Title Generator
        document.addEventListener('DOMContentLoaded', () => {
            const app = document.getElementById('app');
            
            // === YOUR API KEY GOES HERE ===
            // 1. Get your key from https://ai.google.dev/
            // 2. Paste it in the quotes below. Do not share your key!
            const apiKey = "AIzaSyC3m6k8ONG67lMr3YMEGT4svIWaYxig-BY";
            // ==============================

            let primaryKeyword = '';
            let titles = [];
            let loading = false;
            let error = '';

            // Function to copy text to the clipboard
            const copyToClipboard = (text) => {
                if (text) {
                    const tempInput = document.createElement('textarea');
                    tempInput.value = text;
                    document.body.appendChild(tempInput);
                    tempInput.select();
                    document.execCommand('copy');
                    document.body.removeChild(tempInput);
                }
            };

            // Function to render the loading spinner
            const renderLoadingSpinner = () => `
                <svg class="animate-spin h-5 w-5 text-white mx-auto" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                    <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                    <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                </svg>
            `;

            // Renders the UI based on the current state
            const render = () => {
                const content = `
                    <div class="space-y-6">
                        <div>
                            <label for="primary-keyword" class="block text-gray-300 font-bold mb-2">Primary Keyword</label>
                            <input
                                type="text"
                                id="primary-keyword"
                                class="w-full p-3 rounded-lg bg-gray-700 text-white placeholder-gray-400 border border-gray-600 focus:outline-none focus:ring-2 focus:ring-purple-500 transition-colors"
                                placeholder="e.g., Video Editing Tutorial"
                                value="${primaryKeyword}"
                                ${loading ? 'disabled' : ''}
                            />
                        </div>
                        <button id="generate-titles-btn" class="w-full p-4 rounded-lg font-bold text-white transition-all duration-300
                            ${loading ? 'bg-gray-600 cursor-not-allowed' : 'bg-gradient-to-r from-blue-500 to-purple-600 hover:from-blue-600 hover:to-purple-700 transform hover:scale-105'}"
                            ${loading ? 'disabled' : ''}
                        >
                            ${loading ? renderLoadingSpinner() : 'Generate Titles'}
                        </button>
                        ${error ? `<p class="text-red-400 text-center mt-4">${error}</p>` : ''}

                        ${titles.length > 0 ? `
                            <div class="mt-8">
                                <h2 class="text-xl sm:text-2xl font-bold text-gray-200 mb-4 text-center">
                                    Choose a Title:
                                </h2>
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                    ${titles.map((title, index) => `
                                        <div class="bg-gray-700 p-4 rounded-lg flex flex-col justify-between">
                                            <p class="text-white mb-4 break-words">${title}</p>
                                            <button
                                                data-title="${title}"
                                                class="p-2 mt-auto rounded-lg bg-green-500 hover:bg-green-600 text-white font-medium transition-colors copy-title-btn"
                                            >
                                                Copy Title
                                            </button>
                                        </div>
                                    `).join('')}
                                </div>
                            </div>
                        ` : ''}
                    </div>
                `;

                // Main App container
                app.innerHTML = `
                    <div class="min-h-screen bg-gray-900 text-white p-4 sm:p-8 flex items-start justify-center font-sans">
                        <div class="bg-gray-800 p-6 sm:p-10 rounded-xl shadow-2xl w-full max-w-4xl transform transition-all duration-300">
                            <h1 class="text-3xl sm:text-4xl font-extrabold text-center mb-6 text-transparent bg-clip-text bg-gradient-to-r from-blue-400 to-purple-600">
                                YouTube Title Generator ðŸš€
                            </h1>
                            <p class="text-center text-gray-400 mb-8 max-w-lg mx-auto">
                                Enter a primary keyword to generate title ideas.
                            </p>
                            ${content}
                        </div>
                    </div>
                `;

                // Add event listeners after rendering
                attachEventListeners();
            };

            // Attaches all event listeners for the rendered elements
            const attachEventListeners = () => {
                document.getElementById('primary-keyword').addEventListener('input', (e) => {
                    primaryKeyword = e.target.value;
                });
                document.getElementById('generate-titles-btn').addEventListener('click', generateTitles);
                document.querySelectorAll('.copy-title-btn').forEach(button => {
                    button.addEventListener('click', (e) => {
                        copyToClipboard(e.target.dataset.title);
                    });
                });
            };

            // Function to handle the API call for titles
            const generateTitles = async () => {
                if (!primaryKeyword) {
                    error = 'Please enter a primary keyword.';
                    render();
                    return;
                }
                loading = true;
                error = '';
                titles = [];
                render();

                const maxRetries = 5;
                let delay = 1000;

                if (!apiKey || apiKey === "PASTE_YOUR_API_KEY_HERE") {
                    error = 'API Key is missing. Please add your key to the code to proceed.';
                    loading = false;
                    render();
                    return;
                }

                for (let i = 0; i < maxRetries; i++) {
                    try {
                        const prompt = `
                            Generate a JSON array containing 10 creative and effective YouTube titles. Each title must:
                            - Be under 70 characters long.
                            - Include the exact primary keyword: "${primaryKeyword}".
                            - Have a strong hook.
                            - Include a call-to-action (CTA) word.
                            - Contain at least one relevant emoji.
                            - Include some text within brackets, like [Tutorial], (2024), or [LIVE].
                        `;
                        const chatHistory = [{ role: "user", parts: [{ text: prompt }] }];
                        const payload = {
                            contents: chatHistory,
                            generationConfig: {
                                responseMimeType: "application/json",
                                responseSchema: {
                                    type: "ARRAY",
                                    items: { type: "STRING" }
                                }
                            }
                        };
                        const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=${apiKey}`;

                        const response = await fetch(apiUrl, {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify(payload),
                        });

                        if (!response.ok) {
                            throw new Error(`API error: ${response.statusText}`);
                        }

                        const result = await response.json();
                        const jsonText = result?.candidates?.[0]?.content?.parts?.[0]?.text;
                        if (jsonText) {
                            const parsedJson = JSON.parse(jsonText);
                            if (Array.isArray(parsedJson)) {
                                titles = parsedJson;
                                break;
                            }
                        }
                        throw new Error('No valid titles were generated. Please try again.');
                    } catch (e) {
                        if (i < maxRetries - 1) {
                            console.warn(`Title generation attempt ${i + 1} failed. Retrying...`, e.message);
                            await new Promise(res => setTimeout(res, delay));
                            delay *= 2;
                        } else {
                            console.error('All title generation retries failed.', e);
                            error = 'Failed to generate titles. Please try a different keyword or try again later.';
                        }
                    }
                }
                loading = false;
                render();
            };
            
            // Initial render
            render();
        });
    </script>
</body>
</html>
