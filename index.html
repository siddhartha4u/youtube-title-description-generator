<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>YouTube Title & Description Generator</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
            margin: 0;
            background-color: #0d1117;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        // Main App component for the YouTube Title & Description Generator
        const App = () => {
            // State to manage the current step of the tool: 'titles' or 'descriptions'
            const [step, setStep] = React.useState('titles');
            // State for the user's primary keyword
            const [primaryKeyword, setPrimaryKeyword] = React.useState('');
            // State for the secondary keywords (up to 5)
            const [secondaryKeywords, setSecondaryKeywords] = React.useState(['', '', '', '', '']);
            // State for the generated YouTube title ideas (now an array)
            const [titles, setTitles] = React.useState([]);
            // State for the generated description ideas (now an array)
            const [descriptions, setDescriptions] = React.useState([]);
            // State for the title the user has selected from the list
            const [selectedTitle, setSelectedTitle] = React.useState('');
            // State to handle the loading status during API calls
            const [loading, setLoading] = React.useState(false);
            // State to handle any error messages from the API
            const [error, setError] = React.useState('');

            // Function to update a specific secondary keyword
            const handleSecondaryKeywordChange = (index, value) => {
                const newKeywords = [...secondaryKeywords];
                newKeywords[index] = value;
                setSecondaryKeywords(newKeywords);
            };

            // Function to copy the generated text to the clipboard
            const copyToClipboard = React.useCallback((text) => {
                if (text) {
                    const tempInput = document.createElement('textarea');
                    tempInput.value = text;
                    document.body.appendChild(tempInput);
                    tempInput.select();
                    document.execCommand('copy');
                    document.body.removeChild(tempInput);
                }
            }, []);

            // Function to handle title selection and move to the next step
            const handleTitleSelection = React.useCallback((title) => {
                setSelectedTitle(title);
                setDescriptions([]); // Clear previous descriptions
                setStep('descriptions');
            }, []);

            // Function to generate 10 title ideas using the Gemini API
            const generateTitles = React.useCallback(async () => {
                if (!primaryKeyword) {
                    setError('Please enter a primary keyword.');
                    return;
                }
                setLoading(true);
                setError('');
                setTitles([]);
                setSelectedTitle('');
                setDescriptions([]);

                const maxRetries = 5;
                let delay = 1000;

                for (let i = 0; i < maxRetries; i++) {
                    try {
                        const prompt = `
                            Generate 10 creative and effective YouTube titles. Each title must:
                            - Be under 70 characters long.
                            - Include the exact primary keyword: "${primaryKeyword}".
                            - Have a strong hook.
                            - Include a call-to-action (CTA) word.
                            - Contain at least one relevant emoji.
                            - Include some text within brackets, like [Tutorial], (2024), or [LIVE].
                        `;

                        const chatHistory = [{ role: "user", parts: [{ text: prompt }] }];
                        const payload = {
                            contents: chatHistory,
                            generationConfig: {
                                responseMimeType: "application/json",
                                responseSchema: {
                                    type: "OBJECT",
                                    properties: {
                                        titles: {
                                            type: "ARRAY",
                                            items: { type: "STRING" }
                                        }
                                    }
                                }
                            }
                        };
                        const apiKey = "";
                        const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=${apiKey}`;

                        const response = await fetch(apiUrl, {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify(payload),
                        });

                        if (!response.ok) {
                            throw new Error(`API error: ${response.statusText}`);
                        }

                        const result = await response.json();
                        const jsonText = result?.candidates?.[0]?.content?.parts?.[0]?.text;
                        if (jsonText) {
                            const parsedJson = JSON.parse(jsonText);
                            if (parsedJson.titles && Array.isArray(parsedJson.titles)) {
                                setTitles(parsedJson.titles);
                                break;
                            }
                        }
                        throw new Error('No valid titles were generated. Please try again.');
                    } catch (e) {
                        if (i < maxRetries - 1) {
                            console.warn(`Title generation attempt ${i + 1} failed. Retrying...`, e.message);
                            await new Promise(res => setTimeout(res, delay));
                            delay *= 2;
                        } else {
                            console.error('All title generation retries failed.', e);
                            setError('Failed to generate titles. Please try a different keyword or try again later.');
                        }
                    } finally {
                        setLoading(false);
                    }
                }
            }, [primaryKeyword]);

            // Function to generate 5 description ideas based on the selected title and keywords
            const generateDescriptions = React.useCallback(async () => {
                if (!selectedTitle || !primaryKeyword) {
                    setError('Please select a title and enter a primary keyword.');
                    return;
                }
                setLoading(true);
                setError('');
                setDescriptions([]);

                const maxRetries = 5;
                let delay = 1000;

                // Filter out any empty secondary keywords
                const filteredSecondaryKeywords = secondaryKeywords.filter(k => k.trim() !== '');

                for (let i = 0; i < maxRetries; i++) {
                    try {
                        const prompt = `
                            Generate a JSON array containing 5 different YouTube video description ideas for the following title: "${selectedTitle}".
                            Each description must be under 120 words long. It must incorporate the primary keyword "${primaryKeyword}" and also use the following secondary keywords: ${filteredSecondaryKeywords.join(', ')}.
                            Each description should be a few sentences long, include relevant hashtags, and provide a clear call-to-action.
                        `;

                        const chatHistory = [{ role: "user", parts: [{ text: prompt }] }];
                        const payload = {
                            contents: chatHistory,
                            generationConfig: {
                                responseMimeType: "application/json",
                                responseSchema: {
                                    type: "ARRAY",
                                    items: { type: "STRING" }
                                }
                            }
                        };
                        const apiKey = "";
                        const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=${apiKey}`;

                        const response = await fetch(apiUrl, {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify(payload),
                        });

                        if (!response.ok) {
                            throw new Error(`API error: ${response.statusText}`);
                        }

                        const result = await response.json();
                        const jsonText = result?.candidates?.[0]?.content?.parts?.[0]?.text;
                        if (jsonText) {
                            const parsedJson = JSON.parse(jsonText);
                            if (Array.isArray(parsedJson)) {
                                setDescriptions(parsedJson);
                                break;
                            }
                        }
                        throw new Error('The API response was not a valid JSON array of strings. Please try again.');
                    } catch (e) {
                        if (i < maxRetries - 1) {
                            console.warn(`Description generation attempt ${i + 1} failed. Retrying...`, e.message);
                            await new Promise(res => setTimeout(res, delay));
                            delay *= 2;
                        } else {
                            console.error('All description generation retries failed.', e);
                            setError('Failed to generate descriptions. Please try again later.');
                        }
                    } finally {
                        setLoading(false);
                    }
                }
            }, [selectedTitle, primaryKeyword, secondaryKeywords]);

            return (
                <div className="min-h-screen bg-gray-900 text-white p-4 sm:p-8 flex items-start justify-center font-sans">
                    <div className="bg-gray-800 p-6 sm:p-10 rounded-xl shadow-2xl w-full max-w-4xl transform transition-all duration-300">
                        <h1 className="text-3xl sm:text-4xl font-extrabold text-center mb-6 text-transparent bg-clip-text bg-gradient-to-r from-blue-400 to-purple-600">
                            YouTube Title & Description Generator ðŸš€
                        </h1>
                        <p className="text-center text-gray-400 mb-8 max-w-lg mx-auto">
                            {step === 'titles' ? 'Enter a primary keyword to generate title ideas.' : 'Now, generate descriptions using your keywords.'}
                        </p>

                        {error && (
                            <p className="text-red-400 text-center mb-4">{error}</p>
                        )}

                        {/* Step 1: Title Generation */}
                        {step === 'titles' && (
                            <div className="space-y-6">
                                <div>
                                    <label htmlFor="primary-keyword" className="block text-gray-300 font-bold mb-2">Primary Keyword</label>
                                    <input
                                        type="text"
                                        id="primary-keyword"
                                        className="w-full p-3 rounded-lg bg-gray-700 text-white placeholder-gray-400 border border-gray-600 focus:outline-none focus:ring-2 focus:ring-purple-500 transition-colors"
                                        placeholder="e.g., Video Editing Tutorial"
                                        value={primaryKeyword}
                                        onChange={(e) => setPrimaryKeyword(e.target.value)}
                                        disabled={loading}
                                    />
                                </div>
                                <button
                                    onClick={generateTitles}
                                    className={`w-full p-4 rounded-lg font-bold text-white transition-all duration-300
                                    ${loading
                                            ? 'bg-gray-600 cursor-not-allowed'
                                            : 'bg-gradient-to-r from-blue-500 to-purple-600 hover:from-blue-600 hover:to-purple-700 transform hover:scale-105'
                                        }`}
                                    disabled={loading}
                                >
                                    {loading ? (
                                        <svg className="animate-spin h-5 w-5 text-white mx-auto" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                                            <circle className="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" strokeWidth="4"></circle>
                                            <path className="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                                        </svg>
                                    ) : 'Generate Titles'}
                                </button>

                                {titles.length > 0 && (
                                    <div className="mt-8">
                                        <h2 className="text-xl sm:text-2xl font-bold text-gray-200 mb-4 text-center">
                                            Choose a Title:
                                        </h2>
                                        <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                                            {titles.map((title, index) => (
                                                <div key={index} className="bg-gray-700 p-4 rounded-lg flex flex-col justify-between">
                                                    <p className="text-white mb-4 break-words">{title}</p>
                                                    <button
                                                        onClick={() => handleTitleSelection(title)}
                                                        className="p-2 mt-auto rounded-lg bg-purple-500 hover:bg-purple-600 text-white font-medium transition-colors"
                                                        disabled={loading}
                                                    >
                                                        Select this Title
                                                    </button>
                                                </div>
                                            ))}
                                        </div>
                                    </div>
                                )}
                            </div>
                        )}

                        {/* Step 2: Description Generation */}
                        {step === 'descriptions' && (
                            <div className="space-y-6">
                                <div>
                                    <h2 className="text-xl sm:text-2xl font-bold text-gray-200 mb-4 text-center">
                                        Selected Title:
                                    </h2>
                                    <div className="bg-gray-700 p-4 sm:p-6 rounded-lg border-2 border-purple-500 shadow-xl">
                                        <p className="text-lg sm:text-xl text-center text-purple-300 mb-4 break-words">
                                            {selectedTitle}
                                        </p>
                                        <div className="flex justify-center">
                                            <button
                                                onClick={() => copyToClipboard(selectedTitle)}
                                                className="p-2 px-4 rounded-lg bg-green-500 hover:bg-green-600 text-white font-medium transition-colors transform hover:scale-105"
                                            >
                                                Copy Title
                                            </button>
                                        </div>
                                    </div>
                                </div>
                                
                                {/* Keywords for Description */}
                                <div>
                                    <label htmlFor="primary-keyword-desc" className="block text-gray-300 font-bold mb-2">Primary Keyword</label>
                                    <input
                                        type="text"
                                        id="primary-keyword-desc"
                                        className="w-full p-3 rounded-lg bg-gray-700 text-white placeholder-gray-400 border border-gray-600 focus:outline-none focus:ring-2 focus:ring-purple-500 transition-colors"
                                        placeholder="e.g., Video Editing Tutorial"
                                        value={primaryKeyword}
                                        onChange={(e) => setPrimaryKeyword(e.target.value)}
                                        disabled={loading}
                                    />
                                </div>
                                <div>
                                    <label className="block text-gray-300 font-bold mb-2">Secondary Keywords (Optional, up to 5)</label>
                                    <div className="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4">
                                        {secondaryKeywords.map((keyword, index) => (
                                            <input
                                                key={index}
                                                type="text"
                                                className="p-3 rounded-lg bg-gray-700 text-white placeholder-gray-400 border border-gray-600 focus:outline-none focus:ring-2 focus:ring-purple-500 transition-colors"
                                                placeholder={`Keyword ${index + 1}`}
                                                value={keyword}
                                                onChange={(e) => handleSecondaryKeywordChange(index, e.target.value)}
                                                disabled={loading}
                                            />
                                        ))}
                                    </div>
                                </div>
                                
                                <button
                                    onClick={generateDescriptions}
                                    className={`w-full p-4 rounded-lg font-bold text-white transition-all duration-300
                                    ${loading
                                            ? 'bg-gray-600 cursor-not-allowed'
                                            : 'bg-gradient-to-r from-blue-500 to-purple-600 hover:from-blue-600 hover:to-purple-700 transform hover:scale-105'
                                        }`}
                                    disabled={loading}
                                >
                                    {loading ? (
                                        <svg className="animate-spin h-5 w-5 text-white mx-auto" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                                            <circle className="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" strokeWidth="4"></circle>
                                            <path className="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                                        </svg>
                                    ) : 'Generate Descriptions'}
                                </button>
                                <button
                                    onClick={() => setStep('titles')}
                                    className="w-full p-4 rounded-lg font-bold text-white bg-gray-600 hover:bg-gray-700 transition-colors mt-2"
                                >
                                    Go Back to Titles
                                </button>

                                {descriptions.length > 0 && (
                                    <div className="mt-8">
                                        <h2 className="text-xl sm:text-2xl font-bold text-gray-200 mb-4 text-center">
                                            Description Ideas:
                                        </h2>
                                        <div className="flex flex-col gap-4">
                                            {descriptions.map((desc, index) => (
                                                <div key={index} className="bg-gray-700 p-4 rounded-lg">
                                                    <p className="text-white mb-4 whitespace-pre-wrap">{desc}</p>
                                                    <div className="flex justify-center">
                                                        <button
                                                            onClick={() => copyToClipboard(desc)}
                                                            className="p-2 px-4 rounded-lg bg-green-500 hover:bg-green-600 text-white font-medium transition-colors transform hover:scale-105"
                                                        >
                                                            Copy Description
                                                        </button>
                                                    </div>
                                                </div>
                                            ))}
                                        </div>
                                    </div>
                                )}
                            </div>
                        )}
                    </div>
                </div>
            );
        };

        ReactDOM.render(<App />, document.getElementById('root'));
    </script>
</body>
</html>
